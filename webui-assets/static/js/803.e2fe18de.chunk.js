"use strict";(self.webpackChunkec_admin_webui=self.webpackChunkec_admin_webui||[]).push([[803,762],{1905:function(e,t,a){a(2791);t.Z=a.p+"static/media/icon_greensortingdown.31d2161218970ff2041dbc045ec6fafd.svg"},6329:function(e,t,a){a(2791);t.Z=a.p+"static/media/icondelete_tablemaintainmonitor.f14bffdc09e994cbbe0753461f3d9d2c.svg"},9559:function(e,t,a){a(2791);t.Z=a.p+"static/media/iconedit_tablemaintainmonitor.26856b96228dda93f7ced9a4c5284404.svg"},6803:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var s=a(1413),n=a(7762),o=a(5671),r=a(3144),i=a(9340),l=a(5716),c=a(2791),d=a(2810),m=a(8890),h=a.n(m),u=a(1905),p=a(9559),f=a(6329),v=a(8215),b=a(184),y=function(e){(0,i.Z)(a,e);var t=(0,l.Z)(a);function a(e){var s;return(0,o.Z)(this,a),(s=t.call(this,e)).state={formData:{name:{value:"",dirtyState:!1},eventType:{value:"",dirtyState:!1},endpoint:{value:"",dirtyState:!1},secret:{value:"",dirtyState:!1,type:"password"}},errorsForm:{},formIsValid:!1,showForm:!1,WebHookList:[{name:"",eventType:"",endpoint:""}],edit:!1,editKey:"",showTableInit:!1,newTableData:[]},s}return(0,r.Z)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"initTable",value:function(e,t){var a;a=h()("#"+e+"Div")[0].offsetWidth-200,h()("#"+e).DataTable({dom:'rt<"bottom"lp>',bSort:!0,scrollX:!0,language:{paginate:{previous:"<",next:">"}},createdRow:function(e,t,s){for(var n=0;n<t.length;n++)h()("td:eq("+n+")",e).css("min-width",a/t.length+"px")},pageLength:5,destroy:!0,fnDrawCallback:function(e){e.aiDisplay.length<=5?h()(".dataTables_paginate").hide():h()(".dataTables_paginate").show()}}),h()(".bottom").addClass("row"),h()(".dataTables_length").addClass("col-sm-6"),h()(".dataTables_paginate").addClass("col-sm-6")}},{key:"fetchData",value:function(){var e=this,t=[];if(null!==sessionStorage.getItem("snapshotData")){var a=JSON.parse(sessionStorage.getItem("snapshotData")),s=[];Object.keys(a).forEach((function(e){s.push(a[e])}));for(var n=0,o=s;n<o.length;n++){var r=o[n];r.parent&&"5e69f043-966d-438f-9421-83fb18272a7d"===r.parent&&t.push(r)}this.generateTableStructure(t,!1),this.setState({WebHookList:t})}else this.props.showGlobalMessage(!0,!0,"Please try after sometime","custom-danger"),this.setState({WebHookList:[{name:"",eventType:"",endpoint:""}]}),setTimeout((function(){e.props.hideGlobalMessage()}),2e3)}},{key:"generateTableStructure",value:function(e,t){var a,s=this,o=e,r=[],i=(0,n.Z)(o);try{for(i.s();!(a=i.n()).done;){var l=a.value,c={};c.webhookname=l.webhookname,c.eventType=l.eventType,c.endpoint=l.endpoint,c.secret=l.secret,c.key=l.key,r.push(c)}}catch(d){i.e(d)}finally{i.f()}this.setState({newTableData:r,showTableInit:!0}),setTimeout((function(){s.initTable("webhookTable",!0)}),100)}},{key:"handleFormData",value:function(e){var t=e.target.name,a="checkbox"===e.target.type?e.target.checked:e.target.value,s=Object.assign({},this.state.formData);"eventType"===t?(s.eventType.value=a,s.eventType.dirtyState=!0):"endpoint"===t?(s.endpoint.value=a,s.endpoint.dirtyState=!0):"name"===t?(s.name.value=a,s.name.dirtyState=!0):"secret"===t&&(s.secret.value=a,s.secret.dirtyState=!0),this.setState({formData:s}),this.handleFormValidation()}},{key:"handleFormValidation",value:function(){var e=this.state.formData,t=e.name.value,a=e.name.dirtyState,s=e.endpoint.value,n=e.endpoint.dirtyState,o=e.eventType.value,r=e.eventType.dirtyState,i=e.secret.value,l=e.secret.dirtyState,c=!0,d={};""===t.trim()&&(a&&(d.name="Please enter Name"),c=!1),""===s.trim()&&(n&&(d.endpoint="Please enter Api Endpoint"),c=!1),""===o.trim()&&(r&&(d.eventType="Please enter Event Type"),c=!1),""===i.trim()&&(l&&(d.secret="Please enter Secret"),c=!1),this.setState({formIsValid:c,errorsForm:d})}},{key:"showHideField",value:function(e,t){var a={};"password"===(a=Object.assign({},this.state.formData))[t].type?a[t].type="text":a[t].type="password",this.setState({formData:a})}},{key:"createWebHook",value:function(){var e=this;this.props.showGlobalMessage(!0,!0,"Please wait...","custom-success");var t=Object.assign({},this.state.formData),a={},s=(0,d.Z)();a.webhookname=t.name.value,a.eventType=t.eventType.value,a.endpoint=t.endpoint.value,a.secret=btoa(unescape(encodeURIComponent(t.secret.value))),a.parent="5e69f043-966d-438f-9421-83fb18272a7d",a.name="webHook";var n=this.state.edit?"PUT":"POST",o=this.state.edit?"".concat(this.props.baseUrl,"webhook-").concat(this.state.editKey):"".concat(this.props.baseUrl,"webhook-").concat(s);fetch(o,{method:n,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+this.props.authToken},body:JSON.stringify(a)}).then((function(t){localStorage.setItem("prepareData",JSON.stringify(a)),200===t.status?(e.snapshotUpdate(),t.json().then((function(t){"ok"===(t={errorStatus:{status:"ok"}}).errorStatus.status?(e.props.showGlobalMessage(!1,!0,"Record saved successfully","custom-success"),e.state.edit||setTimeout((function(){e.props.hideGlobalMessage();e.setState({formData:{name:{value:"",dirtyState:!1},eventType:{value:"",dirtyState:!1},endpoint:{value:"",dirtyState:!1},secret:{value:"",dirtyState:!1,type:"password"}},formIsValid:!1})}),2e3)):(e.props.showGlobalMessage(!0,!0,t.errorStatus.statusMsg,"custom-danger"),setTimeout((function(){e.props.hideGlobalMessage()}),2e3))}))):(e.props.showGlobalMessage(!0,!0,"Please try after sometime","custom-danger"),setTimeout((function(){e.props.hideGlobalMessage()}),2e3))})).catch((function(t){console.log(t),e.props.showGlobalMessage(!0,!0,"Please try after sometime","custom-danger"),setTimeout((function(){e.props.hideGlobalMessage()}),2e3)}))}},{key:"snapshotUpdate",value:function(){var e=this;fetch(this.props.baseUrl+"snapshot",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+this.props.authToken}}).then((function(t){200===t.status&&t.json().then((function(t){sessionStorage.setItem("snapshotData",JSON.stringify(t)),e.fetchData()}))}))}},{key:"removeDataTableRow",value:function(e,t){h()("#"+e).DataTable().row("#"+e+"TbodyTr_"+t).remove().draw(!1)}},{key:"deleteWebhook",value:function(e,t){var a=this;window.confirm("Are you sure you want to delete")&&(this.props.showGlobalMessage(!0,!0,"Please Wait....","custom-success"),fetch(this.props.baseUrl+e.key,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+this.props.authToken}}).then((function(e){if(200===e.status)e.json().then((function(e){a.props.showGlobalMessage(!1,!0,"Record deleted successfuly","custom-success"),a.removeDataTableRow("webhookTable",t);var s=a;setTimeout((function(){s.props.hideGlobalMessage()}),2e3)}));else{a.props.showGlobalMessage(!0,!0,"Please try after sometime","custom-danger");var s=a;setTimeout((function(){s.props.hideGlobalMessage()}),2e3)}})).catch((function(e){console.log(e),a.props.showGlobalMessage(!0,!0,"Please try after sometime","custom-danger"),setTimeout((function(){a.props.hideGlobalMessage()}),2e3)})))}},{key:"editWebhook",value:function(e){var t=(0,s.Z)({},this.state.formData);t.name.value=e.webhookname,t.eventType.value=e.eventType,t.endpoint.value=e.endpoint,t.secret.value=decodeURIComponent(escape(atob(e.secret)));var a=e.key;this.setState({formData:t,edit:!0,showForm:!0,editKey:a})}},{key:"addWebHook",value:function(){var e=(0,s.Z)({},this.state.formData);e.name.value="",e.eventType.value="",e.endpoint.value="",e.secret.value="",this.setState({formData:e,edit:!1,showForm:!0,editKey:""})}},{key:"render",value:function(){var e=this;return(0,b.jsx)("div",{className:"row web-hook",children:this.state.showForm?(0,b.jsx)("div",{className:"col-md-12 mt-2",children:(0,b.jsx)("div",{className:"centered-div",children:(0,b.jsxs)("div",{className:"centered-div-header",children:[(0,b.jsx)("div",{className:"row WebHooks-header",children:(0,b.jsx)("div",{className:"col-md-12",children:(0,b.jsxs)("h6",{id:"WebHooks-title text-blue",children:["Web Hooks /",(0,b.jsx)("span",{className:"text-black",children:" Add webhook"})]})})}),(0,b.jsx)("hr",{}),(0,b.jsxs)("div",{className:"changeable-form group-form",children:[(0,b.jsxs)("div",{className:"row",children:[(0,b.jsxs)("div",{className:"col-sm-6",children:[(0,b.jsxs)("div",{className:"col-sm-12 label required",children:["NAME",(0,b.jsx)("img",{alt:"down-arrow",src:u.Z})]}),(0,b.jsxs)("div",{className:"col-sm-12 mb-2",children:[(0,b.jsx)("input",{type:"text",className:"form-control form-control-sm",name:"name",value:this.state.formData.name.value,onChange:function(t){e.handleFormData(t)}}),(0,b.jsx)("small",{className:"text-danger",children:this.state.errorsForm.name})]})]}),(0,b.jsxs)("div",{className:"col-sm-6",children:[(0,b.jsxs)("div",{className:"col-sm-12 label required",children:["EVENT TYPE",(0,b.jsx)("img",{alt:"down-arrow",src:u.Z})]}),(0,b.jsxs)("div",{className:"col-sm-12 mb-2",children:[(0,b.jsxs)("select",{className:"form-control form-control-sm",name:"eventType",value:this.state.formData.eventType.value,onChange:function(t){e.handleFormData(t)},children:[(0,b.jsx)("option",{value:"",children:"Choose a event "}),(0,b.jsxs)("option",{value:"Client Agent Restart",children:["Client Agent Restart"," "]}),(0,b.jsx)("option",{value:"Server Agent Restart",children:"Server Agent Restart"}),(0,b.jsx)("option",{value:"Gateway Agent Restart",children:"Gateway Agent Restart"}),(0,b.jsx)("option",{value:"Connection Establish",children:"Connection Establish"})]}),(0,b.jsx)("small",{className:"text-danger",children:this.state.errorsForm.eventType})]})]})]}),(0,b.jsxs)("div",{className:"row",children:[(0,b.jsxs)("div",{className:"col-sm-6",children:[(0,b.jsxs)("div",{className:"col-sm-12 label required",children:["SECRET",(0,b.jsx)("img",{alt:"down-arrow",src:u.Z}),"password"===this.state.formData.secret.type?(0,b.jsx)("i",{onClick:function(t){e.showHideField(t,"secret")},className:"fa fa-eye cursor-pointer",title:"Show"}):(0,b.jsx)("i",{onClick:function(t){e.showHideField(t,"secret")},className:"fa fa-eye-slash cursor-pointer",title:"Hide"})]}),(0,b.jsxs)("div",{className:"col-sm-12 mb-2",children:[(0,b.jsx)("input",{type:this.state.formData.secret.type,autoComplete:"off",className:"form-control form-control-sm",name:"secret",value:this.state.formData.secret.value,onChange:function(t){e.handleFormData(t)}}),(0,b.jsx)("small",{className:"text-danger",children:this.state.errorsForm.secret})]})]}),(0,b.jsxs)("div",{className:"col-sm-6",children:[(0,b.jsxs)("div",{className:"col-sm-12 label required",children:["TARGET ENDPOINT",(0,b.jsx)("img",{alt:"down-arrow",src:u.Z})]}),(0,b.jsxs)("div",{className:"col-sm-12 mb-2",children:[(0,b.jsx)("input",{type:"text",className:""===this.state.formData.endpoint.value?"blur form-control form-control-sm":"form-control form-control-sm",name:"endpoint",value:""===this.state.formData.endpoint.value?"https://":this.state.formData.endpoint.value,onChange:function(t){e.handleFormData(t)}}),(0,b.jsx)("small",{className:"text-danger",children:this.state.errorsForm.endpoint})]})]})]}),(0,b.jsx)("br",{}),(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"col-sm-4"}),(0,b.jsxs)("div",{className:"col-sm-2 mb-2 text-right",children:[(0,b.jsx)("button",{id:"create-group-btn",disabled:!this.state.formIsValid,onClick:this.createWebHook.bind(this),className:"btn btn-sm customize-view-btn",children:this.state.edit?"UPDATE WEBHOOK":"CREATE WEBHOOKS"})," "]}),(0,b.jsx)("div",{className:"col-sm-2 mb-2 text-left",children:(0,b.jsx)("button",{id:"create-group-btn",onClick:function(){return e.setState({showForm:!1})},className:"btn btn-sm customize-view-btn",children:"BACK"})})]})]})]})})}):(0,b.jsx)("div",{className:"row",children:(0,b.jsx)("div",{className:"col-md-12 mt-2",children:(0,b.jsx)("div",{className:"centered-div",children:(0,b.jsxs)("div",{className:"centered-div-header",children:[(0,b.jsxs)("div",{className:"row mt-2 mb-2 WebHooks-header",children:[(0,b.jsx)("div",{className:"col-md-8",children:(0,b.jsxs)("h6",{id:"WebHooks-title",children:["Web Hooks",(0,b.jsx)("small",{children:" Creating Parameters."})]})}),(0,b.jsx)("div",{className:"col-md-4 text-right",children:(0,b.jsx)("button",{onClick:function(){return e.addWebHook()},className:"btn btn-sm customize-view-btn",children:"Add Webhooks"})})]}),(0,b.jsx)("hr",{}),(0,b.jsx)("div",{className:"row",children:(0,b.jsx)("div",{className:"col-sm-12 text-center",id:"webhookTableDiv",children:this.state.showTableInit?this.state.newTableData.length>0?(0,b.jsxs)("table",{id:"webhookTable",className:"table",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Name"}),(0,b.jsx)("th",{children:"Event Type"}),(0,b.jsx)("th",{children:"Target Endpoint"}),(0,b.jsx)("th",{children:"Actions"})]})}),(0,b.jsx)("tbody",{children:this.state.newTableData.map((function(t,a){return(0,b.jsxs)("tr",{id:"webhookTableTbodyTr_"+a,children:[(0,b.jsxs)("td",{children:[t.webhookname," "]}),(0,b.jsxs)("td",{children:[t.eventType," "]}),(0,b.jsxs)("td",{children:[" ",t.endpoint]}),(0,b.jsx)("td",{children:(0,b.jsxs)("span",{className:"action-img",children:[(0,b.jsx)("img",{alt:"edit-icon",title:"Edit",src:p.Z,onClick:function(){return e.editWebhook(t)}}),(0,b.jsx)("img",{onClick:function(){return e.deleteWebhook(t,a)},alt:"delete-icon",title:"Delete",src:f.Z})]})})]},"webhookTableTbodyTr_"+a)}))})]}):(0,b.jsx)("div",{className:"row mt-2",children:(0,b.jsx)("div",{className:"col-md-12",children:(0,b.jsx)("div",{className:"alert alert-success",role:"alert",children:"No record found!"})})}):(0,b.jsx)("p",{className:"text-center loader-icon",children:(0,b.jsx)("img",{alt:"loading",src:v.Z})})})})]})})})})})}}]),a}(c.Component)},2810:function(e,t,a){var s;a.d(t,{Z:function(){return m}});var n=new Uint8Array(16);function o(){if(!s&&!(s="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(n)}var r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var i=function(e){return"string"===typeof e&&r.test(e)},l=[],c=0;c<256;++c)l.push((c+256).toString(16).substr(1));var d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!i(a))throw TypeError("Stringified UUID is invalid");return a};var m=function(e,t,a){var s=(e=e||{}).random||(e.rng||o)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){a=a||0;for(var n=0;n<16;++n)t[a+n]=s[n];return t}return d(s)}},907:function(e,t,a){function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}a.d(t,{Z:function(){return s}})},7762:function(e,t,a){a.d(t,{Z:function(){return n}});var s=a(181);function n(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=(0,s.Z)(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){l=!0,r=e},f:function(){try{i||null==a.return||a.return()}finally{if(l)throw r}}}}},181:function(e,t,a){a.d(t,{Z:function(){return n}});var s=a(907);function n(e,t){if(e){if("string"===typeof e)return(0,s.Z)(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?(0,s.Z)(e,t):void 0}}}}]);
//# sourceMappingURL=803.e2fe18de.chunk.js.map